<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis • sen2tool</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analysis">
<meta property="og:description" content="sen2tool">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sen2tool</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_s2-download.html">Download</a>
    </li>
    <li>
      <a href="../articles/a02_s2-process.html">Pre-Process</a>
    </li>
    <li>
      <a href="../articles/a03_s2-analysis.html">Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a03_s2-analysis_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analysis</h1>
                        <h4 class="author">Darius Görgen</h4>
            
            <h4 class="date">2020-08-14</h4>
      
      
      <div class="hidden name"><code>a03_s2-analysis.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">raster</span>)
<span class="co">#&gt; Loading required package: sp</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sf</span>)
<span class="co">#&gt; Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 6.3.1</span>

<span class="no">br</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/brick.html">brick</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"testregion_comparisonRaster.tif"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"sen2tool"</span>))
<span class="no">layernames</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"testregion_comparisonRaster_layernames.rds"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"sen2tool"</span>))
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span>(<span class="no">br</span>) <span class="kw">=</span> <span class="no">layernames</span>
<span class="no">aoi</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_read.html">st_read</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"testregion_data.gpkg"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"sen2tool"</span>))
<span class="co">#&gt; Reading layer `testregion_data' from data source `/tmp/RtmpT6n3o4/temp_libpath1a55f4f6041/sen2tool/extdata/testregion_data.gpkg' using driver `GPKG'</span>
<span class="co">#&gt; Simple feature collection with 3 features and 47 fields</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XYZ</span>
<span class="co">#&gt; bbox:           xmin: 744663.5 ymin: 3743273 xmax: 753029.7 ymax: 3749316</span>
<span class="co">#&gt; z_range:        zmin: 0 zmax: 0</span>
<span class="co">#&gt; projected CRS:  WGS 84 / UTM zone 42N</span></pre></body></html></div>
<p>In the previous vignettes we downloaded and preprocessed Sentinel 2 tiles matching the spatiotemporal extent of the area of interest. With the <code>evalVI()</code> routine it is possible to analyse the preprocessed raster data based on the zonal statistics of a number of polygons. Here we are assuming that we downloaded and preprocessed Sentinel 2 datasets from June to September for each of the years 2016 to 2019 just as explained in the Download vignette. Additionally, <code>calcIndices()</code> was used to calculate the NDVI of the cloud-free images. Now, the <code>evalVI()</code> function allows us to specify the years which are before and after a point in time we are interested in investigating the NDVI for our polygons. The function will detect which rasters belong to the pre-intervention time period and which ones belong to the post-intervention period and process them separately. In a first step, all images belonging to a single year are averaged. The same procedure is applied for the averaged images within the pre- and post-period. After the averaging of the pixel values in the time dimension, zonal statistics are extracted for the specified polygons and the difference between the post-period and the pre-period is calculated. The call to the functions looks like this:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">images</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="st">"path/to/ndvi/rasters"</span>, <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">".tif$"</span>, <span class="kw">full.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">aoi</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_read.html">st_read</a></span>(<span class="st">"path/to/aoi.shp"</span>)

<span class="no">aoi_data</span> <span class="kw">=</span> <span class="fu">evalVI</span>(<span class="kw">vifiles</span> <span class="kw">=</span> <span class="no">images</span>,
                  <span class="kw">pre_years</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"2016"</span>, <span class="st">"2017"</span>),
                  <span class="kw">post_years</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"2018"</span>, <span class="st">"2019"</span>),
                  <span class="kw">ncores</span> <span class="kw">=</span> <span class="fl">2</span>,
                  <span class="kw">aoi</span> <span class="kw">=</span> <span class="no">aoi</span>,
                  <span class="kw">name</span> <span class="kw">=</span> <span class="st">"NDVI"</span>,
                  <span class="kw">returnRaster</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                  <span class="kw">rasterdir</span> <span class="kw">=</span> <span class="st">"path/to/outdir"</span>,
                  <span class="kw">extent_name</span> <span class="kw">=</span> <span class="st">"testregion"</span>)
<span class="no">br</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/brick.html">brick</a></span>(<span class="st">"path/to/outdir/testregion_comparisionRaster.rif"</span>)
<span class="no">layernames</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="st">"path/to/outdir/testregion_comparisionRaster_layernames.rds"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span>(<span class="no">br</span>) <span class="kw">=</span> <span class="no">layernames</span></pre></body></html></div>
<p>Here we specified that the resulting raster file should be written to disk, which is why we additionally have to specify an extent_name which is appended to the filename. With the settings specified in the code above, we will get a raster file with 35 layers. These layers correspond to the mean, median, maximum, standard deviation and number of observations per pixel for each of the individual years, the pre-period, the post-period, and the difference between these two periods.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">layer</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/pkg/raster/man/nlayers.html">nlayers</a></span>(<span class="no">br</span>), <span class="kw">variable</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span>(<span class="no">br</span>))
<span class="co">#&gt;    layer         variable</span>
<span class="co">#&gt; 1      1   NDVI_mean_2016</span>
<span class="co">#&gt; 2      2 NDVI_median_2016</span>
<span class="co">#&gt; 3      3    NDVI_max_2016</span>
<span class="co">#&gt; 4      4     NDVI_sd_2016</span>
<span class="co">#&gt; 5      5  NDVI_nobsv_2016</span>
<span class="co">#&gt; 6      6   NDVI_mean_2017</span>
<span class="co">#&gt; 7      7 NDVI_median_2017</span>
<span class="co">#&gt; 8      8    NDVI_max_2017</span>
<span class="co">#&gt; 9      9     NDVI_sd_2017</span>
<span class="co">#&gt; 10    10  NDVI_nobsv_2017</span>
<span class="co">#&gt; 11    11   NDVI_mean_2018</span>
<span class="co">#&gt; 12    12 NDVI_median_2018</span>
<span class="co">#&gt; 13    13    NDVI_max_2018</span>
<span class="co">#&gt; 14    14     NDVI_sd_2018</span>
<span class="co">#&gt; 15    15  NDVI_nobsv_2018</span>
<span class="co">#&gt; 16    16   NDVI_mean_2019</span>
<span class="co">#&gt; 17    17 NDVI_median_2019</span>
<span class="co">#&gt; 18    18    NDVI_max_2019</span>
<span class="co">#&gt; 19    19     NDVI_sd_2019</span>
<span class="co">#&gt; 20    20  NDVI_nobsv_2019</span>
<span class="co">#&gt; 21    21    NDVI_mean_pre</span>
<span class="co">#&gt; 22    22  NDVI_median_pre</span>
<span class="co">#&gt; 23    23     NDVI_max_pre</span>
<span class="co">#&gt; 24    24      NDVI_sd_pre</span>
<span class="co">#&gt; 25    25   NDVI_nobsv_pre</span>
<span class="co">#&gt; 26    26   NDVI_mean_post</span>
<span class="co">#&gt; 27    27 NDVI_median_post</span>
<span class="co">#&gt; 28    28    NDVI_max_post</span>
<span class="co">#&gt; 29    29     NDVI_sd_post</span>
<span class="co">#&gt; 30    30  NDVI_nobsv_post</span>
<span class="co">#&gt; 31    31   NDVI_mean_diff</span>
<span class="co">#&gt; 32    32 NDVI_median_diff</span>
<span class="co">#&gt; 33    33    NDVI_max_diff</span>
<span class="co">#&gt; 34    34     NDVI_sd_diff</span>
<span class="co">#&gt; 35    35  NDVI_nobsv_diff</span></pre></body></html></div>
<p>One important feature one has to keep in mind about satellite observations is that a given area of interest might only be partly covered by the tiles the satellite data is provided. This is the reasons why some pixels might be more frequently covered by observations than others. Let us visualisze this effect by looking at the number of observations per pixels for 2019.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(<span class="no">br</span>$<span class="no">NDVI_nobsv_2019</span>)</pre></body></html></div>
<p><img src="a03_s2-analysis_files/figure-html/unnamed-chunk-2-1.png" width="700"> As we can see here, the East side of the area of interest is more frequently covered by individual satellite observations than the center and West part. We can also observe round shapes in the center of the area which represent missing observations due to clouds. With this high number of observations, the effects on the values of the NDVI are not very substantial. However, as the number of observations generally decrease some bias might be introduced. This can be visuallised by using the data of 2015. In June of that year Sentinel-2A was launched and Sentinel-2B was not launched until March 2017. Let’s take a look at the number of observations, the mean value and the standard deviation.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(<span class="no">br</span><span class="kw">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span>(<span class="no">br</span>) <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"NDVI_nobsv_2016"</span>, <span class="st">"NDVI_mean_2016"</span>, <span class="st">"NDVI_sd_2016"</span>))]])</pre></body></html></div>
<p><img src="a03_s2-analysis_files/figure-html/unnamed-chunk-3-1.png" width="700"> We see that the majority of the study area only show two observations while on the East side this value increases up to six. For the mean NDVI no clear bias is observable, however when it comes to the standard deviation we clearly observe artifacts based on the number of observations. In the center locations the parameters are calculated based only on two single values while in the East more observations contribute to the calculations. This effect should be kept in mind when analyzing a given study area. A high number of observations generally reduces the bias, which is why the effect should not be as substantial for time periods after March 2017 when both satellites started to deliver observation data.</p>
<p>The zonal statistics derived for the polygons of interest are based on these raster data sets. All pixels of each layer presented above is extracted for each polygon and an averaged value is returned. This sums up to a total of 35 additional columns in the case presented here</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span>(<span class="no">aoi</span>)
<span class="co">#&gt;  [1] "Name"             "descriptio"       "timestamp"        "begin"           </span>
<span class="co">#&gt;  [5] "end"              "altitudeMo"       "tessellate"       "extrude"         </span>
<span class="co">#&gt;  [9] "visibility"       "drawOrder"        "icon"             "snippet"         </span>
<span class="co">#&gt; [13] "NDVI_mean_2016"   "NDVI_median_2016" "NDVI_max_2016"    "NDVI_sd_2016"    </span>
<span class="co">#&gt; [17] "NDVI_nobsv_2016"  "NDVI_mean_2017"   "NDVI_median_2017" "NDVI_max_2017"   </span>
<span class="co">#&gt; [21] "NDVI_sd_2017"     "NDVI_nobsv_2017"  "NDVI_mean_2018"   "NDVI_median_2018"</span>
<span class="co">#&gt; [25] "NDVI_max_2018"    "NDVI_sd_2018"     "NDVI_nobsv_2018"  "NDVI_mean_2019"  </span>
<span class="co">#&gt; [29] "NDVI_median_2019" "NDVI_max_2019"    "NDVI_sd_2019"     "NDVI_nobsv_2019" </span>
<span class="co">#&gt; [33] "NDVI_mean_pre"    "NDVI_median_pre"  "NDVI_max_pre"     "NDVI_sd_pre"     </span>
<span class="co">#&gt; [37] "NDVI_nobsv_pre"   "NDVI_mean_post"   "NDVI_median_post" "NDVI_max_post"   </span>
<span class="co">#&gt; [41] "NDVI_sd_post"     "NDVI_nobsv_post"  "NDVI_mean_diff"   "NDVI_median_diff"</span>
<span class="co">#&gt; [45] "NDVI_max_diff"    "NDVI_sd_diff"     "NDVI_nobsv_diff"  "geom"</span></pre></body></html></div>
<p>Let’s have a quick look how the average NDVI values behave differentiated between the pre- and post-intervention years.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:raster':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, select, union</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'tidyr'</span>
<span class="co">#&gt; The following object is masked from 'package:raster':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     extract</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">stringr</span>)

<span class="no">aoi</span>$<span class="no">id</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">nrow</a></span>(<span class="no">aoi</span>))
<span class="no">aoi</span> <span class="kw">%&gt;%</span>
  <span class="no">st_drop_geometry</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">ends_with</a></span>(<span class="st">"_pre"</span>), <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">ends_with</a></span>(<span class="st">"_post"</span>), <span class="st">"id"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="no">var</span>,<span class="no">value</span>, -<span class="no">id</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span>(<span class="no">var</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"para"</span>, <span class="st">"var"</span>, <span class="st">"period"</span>), <span class="st">"_"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">period</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">period</span>, <span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"pre"</span>,<span class="st">"post"</span>), <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"pre"</span>, <span class="st">"post"</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">var</span> <span class="kw">==</span> <span class="st">"mean"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">value</span> <span class="kw">=</span> <span class="no">value</span>/<span class="fl">10000</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">value</span>, <span class="kw">x</span><span class="kw">=</span><span class="no">id</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">id</span>), <span class="kw">stat</span><span class="kw">=</span><span class="st">"identity"</span>, <span class="kw">width</span> <span class="kw">=</span> <span class="fl">.5</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(~<span class="no">period</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="st">"Polygon ID"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Average NDVI value"</span>, <span class="kw">x</span><span class="kw">=</span><span class="st">"Polygon"</span>)+
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>()</pre></body></html></div>
<p><img src="a03_s2-analysis_files/figure-html/plot-1.png" width="700"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://maptailor.net/">MapTailor GbR</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
